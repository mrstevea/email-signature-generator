<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SpendRule Email Signature Generator</title>
  <meta name="description" content="Generate professional email signatures for SpendRule team members">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚úâÔ∏è</text></svg>">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f5;
      min-height: 100vh;
      padding: 40px 20px;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    
    .header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }
    
    h1 {
      font-size: 24px;
      font-weight: 600;
      color: #000;
    }
    
    .subtitle {
      color: #666;
      margin-bottom: 32px;
    }
    
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 32px;
    }
    
    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }
      
      .preview-section {
        position: relative !important;
        top: 0 !important;
      }
    }
    
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .card h2 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 20px;
      color: #000;
    }
    
    .form-group {
      margin-bottom: 16px;
    }
    
    .form-group:last-child {
      margin-bottom: 0;
    }
    
    label {
      display: block;
      font-size: 13px;
      font-weight: 500;
      color: #333;
      margin-bottom: 6px;
    }
    
    label .required {
      color: #FF4F00;
    }
    
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="url"] {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    
    input:focus {
      outline: none;
      border-color: #FF4F00;
      box-shadow: 0 0 0 3px rgba(255, 79, 0, 0.1);
    }
    
    input::placeholder {
      color: #aaa;
    }
    
    .preview-section {
      position: sticky;
      top: 20px;
    }
    
    .preview-label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #999;
      margin-bottom: 16px;
    }
    
    .preview-box {
      background: #fff;
      border: 1px solid #eee;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      min-height: 160px;
    }
    
    .button-group {
      display: flex;
      gap: 12px;
    }
    
    button {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .btn-primary {
      background: #FF4F00;
      color: #fff;
    }
    
    .btn-primary:hover {
      background: #e54500;
    }
    
    .btn-primary:active {
      transform: scale(0.98);
    }
    
    .btn-secondary {
      background: #f0f0f0;
      color: #333;
    }
    
    .btn-secondary:hover {
      background: #e5e5e5;
    }
    
    .message {
      padding: 12px 16px;
      border-radius: 8px;
      margin-top: 16px;
      font-size: 14px;
      display: none;
      text-align: center;
    }
    
    .message.show {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    .message.success {
      background: #d4edda;
      color: #155724;
    }
    
    .message.warning {
      background: #fff3cd;
      color: #856404;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .code-section {
      margin-top: 24px;
    }
    
    .code-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    
    .code-header h3 {
      font-size: 14px;
      font-weight: 600;
    }
    
    .code-copy-btn {
      font-size: 12px;
      padding: 6px 12px;
      background: #f0f0f0;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      color: #666;
      flex: none;
    }
    
    .code-copy-btn:hover {
      background: #e5e5e5;
      color: #333;
    }
    
    .code-box {
      background: #1e1e1e;
      border-radius: 8px;
      padding: 16px;
      max-height: 200px;
      overflow-y: auto;
    }
    
    .code-box code {
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 11px;
      color: #d4d4d4;
      white-space: pre-wrap;
      word-break: break-all;
      line-height: 1.5;
    }
    
    .helper-text {
      font-size: 12px;
      color: #888;
      margin-top: 4px;
    }
    
    .divider {
      height: 1px;
      background: #eee;
      margin: 20px 0;
    }
    
    .section-title {
      font-size: 13px;
      font-weight: 600;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 16px;
    }
    
    /* Hosting Guide Modal */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .modal-overlay.show {
      display: flex;
    }
    
    .modal {
      background: #fff;
      border-radius: 16px;
      max-width: 560px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 24px;
      border-bottom: 1px solid #eee;
    }
    
    .modal-header h2 {
      font-size: 18px;
      font-weight: 600;
      margin: 0;
    }
    
    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      color: #999;
      cursor: pointer;
      padding: 0;
      line-height: 1;
    }
    
    .modal-close:hover {
      color: #333;
    }
    
    .modal-body {
      padding: 24px;
    }
    
    .hosting-option {
      border: 1px solid #eee;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      transition: border-color 0.2s;
    }
    
    .hosting-option:hover {
      border-color: #FF4F00;
    }
    
    .hosting-option:last-child {
      margin-bottom: 0;
    }
    
    .hosting-option h3 {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .hosting-option .badge {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 4px;
      font-weight: 500;
    }
    
    .badge.recommended {
      background: #d4edda;
      color: #155724;
    }
    
    .badge.easy {
      background: #cce5ff;
      color: #004085;
    }
    
    .hosting-option p {
      font-size: 13px;
      color: #666;
      margin-bottom: 12px;
    }
    
    .hosting-option ol {
      font-size: 13px;
      color: #444;
      padding-left: 20px;
      margin: 0;
    }
    
    .hosting-option li {
      margin-bottom: 6px;
    }
    
    .hosting-option a {
      color: #FF4F00;
      text-decoration: none;
    }
    
    .hosting-option a:hover {
      text-decoration: underline;
    }
    
    /* Signature Preview Styles */
    .sig-photo {
      width: 68px;
      height: 68px;
      border-radius: 12px;
      object-fit: cover;
      background: #f0f0f0;
    }
    
    .sig-name {
      font-family: Arial, sans-serif;
      font-size: 16px;
      color: #000;
      letter-spacing: -0.35px;
      line-height: 1.2;
    }
    
    .sig-title {
      font-family: Arial, sans-serif;
      font-size: 12px;
      color: #7F7F7F;
      letter-spacing: -0.26px;
      line-height: 1;
      margin-top: 3px;
    }
    
    .sig-contact {
      font-family: Arial, sans-serif;
      font-size: 12px;
      color: #7F7F7F;
      letter-spacing: -0.22px;
      line-height: 1.2;
      margin-top: 13px;
    }
    
    .sig-contact a {
      color: #7F7F7F;
      text-decoration: none;
      display: block;
      margin-top: 4px;
    }
    
    .sig-contact a:first-child {
      margin-top: 0;
    }
    
    .sig-contact a.website {
      color: #FF4F00;
    }
    
    .sig-logo {
      width: 67px;
      height: 14px;
      object-fit: contain;
    }
    
    .footer {
      text-align: center;
      margin-top: 48px;
      padding-top: 24px;
      border-top: 1px solid #eee;
      color: #999;
      font-size: 13px;
    }
    
    .footer a {
      color: #FF4F00;
      text-decoration: none;
    }
    
    .footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>SpendRule Email Signature Generator</h1>
    </div>
    <p class="subtitle">Fill in your details to generate your professional email signature</p>
    
    <div class="grid">
      <!-- Form Section -->
      <div class="card">
        <h2>Your Details</h2>
        
        <div class="section-title">Personal Information</div>
        
        <div class="form-group">
          <label for="fullName">Full Name <span class="required">*</span></label>
          <input type="text" id="fullName" placeholder="Joseph Akintolayo" value="Joseph Akintolayo">
        </div>
        
        <div class="form-group">
          <label for="jobTitle">Job Title <span class="required">*</span></label>
          <input type="text" id="jobTitle" placeholder="CTO & Co-Founder" value="CTO & Co-Founder">
        </div>
        
        <div class="divider"></div>
        <div class="section-title">Contact Information</div>
        
        <div class="form-group">
          <label for="email">Email Address <span class="required">*</span></label>
          <input type="email" id="email" placeholder="joseph@spendrule.com" value="joseph@spendrule.com">
        </div>
        
        <div class="form-group">
          <label for="phone">Phone Number <span class="required">*</span></label>
          <input type="tel" id="phone" placeholder="+1 (469) 998-2727" value="+1 (469) 998-2727">
          <p class="helper-text">Use international format: +1 (xxx) xxx-xxxx</p>
        </div>
        
        <div class="form-group">
          <label for="website">Website Display Text</label>
          <input type="text" id="website" placeholder="spendrule.com" value="spendrule.com">
        </div>
        
        <div class="form-group">
          <label for="websiteUrl">Website URL</label>
          <input type="url" id="websiteUrl" placeholder="https://spendrule.com" value="https://spendrule.com">
        </div>
        
        <div class="divider"></div>
        <div class="section-title">Profile Photo</div>
        
        <div class="form-group">
          <label for="photoUrl">Photo URL</label>
          <input type="url" id="photoUrl" placeholder="https://cdn.example.com/photos/your-photo.jpg">
          <p class="helper-text">Recommended: 136√ó136px (displays at 68√ó68px)</p>
        </div>
        
        <button class="btn-secondary" onclick="showHostingGuide()" style="width: 100%; margin-top: 8px;">
          üìñ How to Host Images
        </button>
      </div>
      
      <!-- Preview Section -->
      <div class="preview-section">
        <div class="card">
          <h2>Preview</h2>
          <p class="preview-label">Live preview of your signature</p>
          
          <div class="preview-box" id="signaturePreview">
            <!-- Preview will be rendered here -->
          </div>
          
          <div class="button-group">
            <button class="btn-primary" onclick="copySignature()">
              üìã Copy Signature
            </button>
            <button class="btn-secondary" onclick="downloadHtml()">
              ‚¨áÔ∏è Download HTML
            </button>
          </div>
          
          <div class="message" id="messageBox"></div>
        </div>
        
        <div class="card code-section">
          <div class="code-header">
            <h3>HTML Code</h3>
            <button class="code-copy-btn" onclick="copyHtmlCode()">Copy Code</button>
          </div>
          <div class="code-box">
            <code id="htmlCode"></code>
          </div>
        </div>
      </div>
    </div>
    
    <div class="footer">
      <p>Built for <a href="https://spendrule.com" target="_blank" rel="noopener noreferrer">SpendRule</a> ¬∑ <a href="https://github.com/spendrule/email-signature-generator" target="_blank" rel="noopener noreferrer">View on GitHub</a></p>
    </div>
  </div>
  
  <!-- Hosting Guide Modal -->
  <div class="modal-overlay" id="hostingModal" onclick="closeHostingGuide(event)">
    <div class="modal" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h2>üìñ How to Host Your Images</h2>
        <button class="modal-close" onclick="closeHostingGuide()">&times;</button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 20px; color: #666;">Email clients (Gmail, Outlook) need images hosted online. Here are the easiest options:</p>
        
        <div class="hosting-option">
          <h3>
            Imgur
            <span class="badge easy">Easiest</span>
          </h3>
          <p>Free, no account needed for basic uploads.</p>
          <ol>
            <li>Go to <a href="https://imgur.com/upload" target="_blank" rel="noopener noreferrer">imgur.com/upload</a></li>
            <li>Drag & drop your image</li>
            <li>Right-click the uploaded image ‚Üí "Copy image address"</li>
            <li>Paste the URL in the field above</li>
          </ol>
        </div>
        
        <div class="hosting-option">
          <h3>
            Cloudinary
            <span class="badge recommended">Recommended</span>
          </h3>
          <p>Free tier with 25GB. Better for professional use with image optimization.</p>
          <ol>
            <li>Sign up at <a href="https://cloudinary.com" target="_blank" rel="noopener noreferrer">cloudinary.com</a> (free)</li>
            <li>Go to Media Library ‚Üí Upload</li>
            <li>Click on uploaded image ‚Üí Copy URL</li>
            <li>Paste the URL in the field above</li>
          </ol>
        </div>
        
        <div class="hosting-option">
          <h3>
            Google Drive
            <span class="badge easy">If you use Google Workspace</span>
          </h3>
          <p>Use your existing Google Drive storage.</p>
          <ol>
            <li>Upload image to Google Drive</li>
            <li>Right-click ‚Üí Share ‚Üí "Anyone with link"</li>
            <li>Copy link, extract the file ID (the long string after /d/)</li>
            <li>Use format: <code style="font-size: 11px;">https://drive.google.com/uc?id=YOUR_FILE_ID</code></li>
          </ol>
        </div>
        
        <div class="hosting-option">
          <h3>
            Your Own Server / CDN
            <span class="badge recommended">Best for teams</span>
          </h3>
          <p>If SpendRule has a CDN or asset server, upload there for reliability.</p>
          <ol>
            <li>Upload images to your company CDN or S3 bucket</li>
            <li>Get the public URL</li>
            <li>Paste the URL in the field above</li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Get form elements
    const inputs = {
      fullName: document.getElementById('fullName'),
      jobTitle: document.getElementById('jobTitle'),
      email: document.getElementById('email'),
      phone: document.getElementById('phone'),
      photoUrl: document.getElementById('photoUrl'),
      website: document.getElementById('website'),
      websiteUrl: document.getElementById('websiteUrl')
    };
    
    const previewEl = document.getElementById('signaturePreview');
    const htmlCodeEl = document.getElementById('htmlCode');
    const messageBox = document.getElementById('messageBox');
    
    // Default placeholder images
    const PLACEHOLDER_PHOTO = "https://via.placeholder.com/136x136/f0f0f0/999999?text=Photo";
    
    // Permanent SpendRule logo (embedded SVG as data URI)
    const SPENDRULE_LOGO = "data:image/svg+xml,%3Csvg width='134' height='28' viewBox='0 0 134 28' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 17.161H3.36168C3.36168 18.3342 4.45229 19.1184 6.04483 19.1184C7.51963 19.1184 8.4925 18.4259 8.4925 17.4614C8.4925 14.6914 0.232374 16.2282 0.232374 10.7766C0.232374 7.79474 2.56231 5.96069 5.89611 5.96069C9.2299 5.96069 11.6187 7.85798 11.6187 10.628L8.25703 10.628C8.25703 9.57503 7.28416 8.85089 5.86822 8.85089C4.45229 8.85089 3.56617 9.48332 3.56617 10.4162C3.56617 13.0945 11.8573 11.6209 11.8573 17.1009C11.8573 20.0828 9.52734 22.0402 6.01694 22.0402C2.50654 22.0402 0 20.0512 0 17.161Z' fill='black'/%3E%3Cpath d='M13.1553 6.32435L16.4581 6.32435V8.52204C17.7253 6.92516 19.5564 5.96387 21.7686 5.96387C25.9885 5.96387 29.1736 9.42642 29.1736 14.002C29.1736 18.5777 25.9885 22.0402 21.7686 22.0402C19.5564 22.0402 17.7284 21.0758 16.4581 19.482V27.4001H13.1553L13.1553 6.32435ZM25.7531 14.002C25.7531 11.2921 23.7763 9.21455 21.1211 9.21455C18.4658 9.21455 16.4612 11.2921 16.4612 14.002C16.4612 16.712 18.4658 18.7895 21.1211 18.7895C23.7763 18.7895 25.7531 16.712 25.7531 14.002Z' fill='black'/%3E%3Cpath d='M29.645 14.002C29.645 9.42642 33.0966 5.96387 37.6697 5.96387C42.2428 5.96387 45.7222 9.42642 45.7222 14.0337C45.7222 14.4542 45.6912 14.9064 45.6324 15.2985L33.1833 15.2985C33.6852 17.5278 35.4544 19.0014 37.8153 19.0014C39.5566 19.0014 41.0592 18.2203 41.8276 17.044H45.4867C44.2784 20.0259 41.3257 22.0434 37.7564 22.0434C33.0966 22.0434 29.645 18.5808 29.645 14.0052V14.002ZM33.2143 12.5253L42.1839 12.5253C41.682 10.4162 39.9129 9.00269 37.6697 9.00269C35.4265 9.00269 33.7472 10.3877 33.2143 12.5253Z' fill='black'/%3E%3Cpath d='M46.9614 6.32435L50.2642 6.32435V8.28172C51.4726 6.77654 53.2138 5.96387 55.3393 5.96387C58.9086 5.96387 61.2974 8.37342 61.2974 12.0162V17.0156C61.2974 17.8883 61.7993 18.429 62.6544 18.429H62.9488V21.6797H62.0038C59.3795 21.6797 57.9915 20.3232 57.9915 17.765V13.1293C57.9915 10.7798 56.5167 9.21455 54.2456 9.21455C51.8568 9.21455 50.2642 10.8114 50.2642 13.1894V21.6797H46.9614V6.32435Z' fill='black'/%3E%3Cpath d='M62.772 14.002C62.772 9.42636 65.9292 5.96381 70.177 5.96381C72.3892 5.96381 74.2172 6.92826 75.4565 8.52198V0L78.7593 0V17.0123C78.7593 17.8851 79.2612 18.4258 80.1474 18.4258H83.5121V21.6765H79.4688C77.4053 21.6765 76.1072 20.8322 75.6641 19.2385C74.3969 20.984 72.479 22.0402 70.177 22.0402C65.9292 22.0402 62.772 18.5776 62.772 14.002ZM75.4565 14.002C75.4565 11.292 73.4798 9.21449 70.8245 9.21449C68.1692 9.21449 66.1646 11.292 66.1646 14.002C66.1646 16.7119 68.1414 18.7895 70.8245 18.7895C73.5077 18.7895 75.4565 16.7119 75.4565 14.002Z' fill='black'/%3E%3Cpath d='M81.269 6.32431L84.5719 6.32431V8.88248C85.7523 7.13698 87.4936 6.08398 89.6159 6.08398H94.0992V9.54653H89.6159C86.4308 9.54653 84.5719 11.3837 84.5719 14.2139V21.6797H81.269V6.32431Z' fill='black'/%3E%3Cpath d='M90.7965 16.108V6.32434L94.0994 6.32434V15.1151C94.0994 17.3128 95.4843 18.7895 97.6098 18.7895C99.853 18.7895 101.356 17.2843 101.356 15.055V6.32434L104.658 6.32434V17.0124C104.658 17.8851 105.188 18.4259 106.046 18.4259L113.157 18.4259V21.6766L105.368 21.6766C103.391 21.6766 102.124 20.8923 101.622 19.4472C100.473 21.1327 98.7314 22.037 96.547 22.037C93.0955 22.037 90.7935 19.6876 90.7935 16.1049L90.7965 16.108Z' fill='black'/%3E%3Cpath d='M107.403 17.4013V0L110.706 0V16.6487C110.706 17.7618 111.385 18.4258 112.475 18.4258H113.389V21.6765H112.004C108.996 21.6765 107.403 20.1713 107.403 17.4013Z' fill='black'/%3E%3Cpath d='M112.949 14.002C112.949 9.42642 116.401 5.96387 120.974 5.96387C125.547 5.96387 129.026 9.42642 129.026 14.0337C129.026 14.4542 128.999 14.9064 128.937 15.2985L116.488 15.2985C116.989 17.5278 118.759 19.0014 121.12 19.0014C122.861 19.0014 124.363 18.2203 125.132 17.044H128.791C127.583 20.0259 124.633 22.0434 121.061 22.0434C116.401 22.0434 112.949 18.5808 112.949 14.0052V14.002ZM116.518 12.5253L125.488 12.5253C124.986 10.4162 123.217 9.00269 120.974 9.00269C118.731 9.00269 117.051 10.3877 116.518 12.5253Z' fill='black'/%3E%3Cpath d='M128.937 19.539C128.937 18.1824 129.969 17.1294 131.298 17.1294C132.627 17.1294 133.659 18.1824 133.659 19.539C133.659 20.8955 132.655 21.9169 131.298 21.9169C129.941 21.9169 128.937 20.8923 128.937 19.539Z' fill='%23FF4F00'/%3E%3C/svg%3E";
    
    // Check if URL is valid
    function isValidUrl(string) {
      if (!string) return false;
      try {
        const url = new URL(string);
        return url.protocol === 'http:' || url.protocol === 'https:';
      } catch (_) {
        return false;
      }
    }
    
    // Get the image source (hosted URL or placeholder)
    function getPhotoSrc() {
      const url = inputs.photoUrl.value.trim();
      return isValidUrl(url) ? url : PLACEHOLDER_PHOTO;
    }
    
    // Logo is always the permanent SpendRule logo
    function getLogoSrc() {
      return SPENDRULE_LOGO;
    }
    
    // Generate HTML signature
    function generateSignatureHtml(data) {
      const photoSrc = getPhotoSrc();
      const logoSrc = getLogoSrc();
      const phoneClean = data.phone.replace(/[^+\d]/g, '');
      
      // Escape HTML entities
      const escapeHtml = (str) => {
        return str
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;');
      };
      
      const name = escapeHtml(data.fullName);
      const title = escapeHtml(data.jobTitle);
      const email = escapeHtml(data.email);
      const phone = escapeHtml(data.phone);
      const website = escapeHtml(data.website);
      const websiteUrl = escapeHtml(data.websiteUrl);
      
      return `<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Email Signature - ${name}</title>
<style type="text/css">a { text-decoration: none; }</style>
</head>
<body style="margin: 0; padding: 0;">
<table cellpadding="0" cellspacing="0" border="0" style="font-family: Arial, Helvetica, sans-serif; background-color: #FFFFFF;">
  <tr>
    <td>
      <table cellpadding="0" cellspacing="0" border="0">
        <!-- Profile Photo -->
        <tr>
          <td style="padding-bottom: 16px;">
            <!--[if mso]>
            <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" style="width:68px;height:68px;v-text-anchor:middle;" arcsize="18%" strokeweight="0" fillcolor="#FFFFFF" stroke="f">
            <v:fill type="frame" src="${photoSrc}" />
            <w:anchorlock/>
            </v:roundrect>
            <![endif]-->
            <!--[if !mso]><!-->
            <img src="${photoSrc}" alt="${name} - Profile Photo" width="68" height="68" style="display: block; width: 68px; height: 68px; border-radius: 12px; object-fit: cover; border: 0;" />
            <!--<![endif]-->
          </td>
        </tr>
        <!-- Content + Logo Row -->
        <tr>
          <td>
            <table cellpadding="0" cellspacing="0" border="0" width="100%">
              <tr>
                <!-- Text Content -->
                <td valign="bottom" style="vertical-align: bottom;">
                  <!-- Name & Title -->
                  <table cellpadding="0" cellspacing="0" border="0">
                    <tr>
                      <td style="padding: 0; line-height: 1.2;">
                        <span style="font-family: Arial, Helvetica, sans-serif; font-size: 16px; font-weight: normal; color: #000000; letter-spacing: -0.35px; display: block; margin: 0;">${name}</span>
                      </td>
                    </tr>
                    <tr>
                      <td style="padding-top: 6px; line-height: 1.2;">
                        <span style="font-family: Arial, Helvetica, sans-serif; font-size: 12px; font-weight: normal; color: #7F7F7F; letter-spacing: -0.26px; display: block; margin: 0;">${title}</span>
                      </td>
                    </tr>
                  </table>
                  <!-- Spacer -->
                  <table cellpadding="0" cellspacing="0" border="0">
                    <tr>
                      <td height="13" style="height: 13px; font-size: 0; line-height: 0;">&nbsp;</td>
                    </tr>
                  </table>
                  <!-- Contact Info -->
                  <table cellpadding="0" cellspacing="0" border="0">
                    <tr>
                      <td style="padding: 0; line-height: 1.2;">
                        <a href="mailto:${email}" style="font-family: Arial, Helvetica, sans-serif; font-size: 12px; color: #7F7F7F; text-decoration: none; letter-spacing: -0.22px; display: block;">${email}</a>
                      </td>
                    </tr>
                    <tr>
                      <td style="padding-top: 4px; line-height: 1.2;">
                        <a href="tel:${phoneClean}" style="font-family: Arial, Helvetica, sans-serif; font-size: 12px; color: #7F7F7F; text-decoration: none; letter-spacing: -0.22px; display: block;">${phone}</a>
                      </td>
                    </tr>
                    <tr>
                      <td style="padding-top: 4px; line-height: 1.2;">
                        <a href="${websiteUrl}" target="_blank" rel="noopener noreferrer" style="font-family: Arial, Helvetica, sans-serif; font-size: 12px; color: #FF4F00; text-decoration: none; letter-spacing: -0.22px; display: block;">${website}</a>
                      </td>
                    </tr>
                  </table>
                </td>
                <!-- Spacer -->
                <td width="16" style="width: 16px; font-size: 0; line-height: 0;">&nbsp;</td>
                <!-- Logo -->
                <td width="67" valign="bottom" style="vertical-align: bottom; width: 67px;">
                  <a href="${websiteUrl}" target="_blank" rel="noopener noreferrer" style="text-decoration: none;">
                    <img src="${logoSrc}" alt="SpendRule" width="67" height="14" style="display: block; width: 67px; height: 14px; border: 0;" />
                  </a>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
</body>
</html>`;
    }
    
    // Generate preview HTML (simplified for display)
    function generatePreviewHtml(data) {
      const photoSrc = getPhotoSrc();
      const logoSrc = SPENDRULE_LOGO;
      
      return `
        <table cellpadding="0" cellspacing="0" border="0" style="font-family: Arial, sans-serif;">
          <tr>
            <td style="padding-bottom: 16px;">
              <img src="${photoSrc}" class="sig-photo" alt="Profile" onerror="this.src='${PLACEHOLDER_PHOTO}'" />
            </td>
          </tr>
          <tr>
            <td>
              <table cellpadding="0" cellspacing="0" border="0">
                <tr>
                  <td valign="bottom">
                    <div class="sig-name">${data.fullName || 'Your Name'}</div>
                    <div class="sig-title">${data.jobTitle || 'Your Title'}</div>
                    <div class="sig-contact">
                      <a href="mailto:${data.email}">${data.email || 'email@example.com'}</a>
                      <a href="tel:${data.phone}">${data.phone || '+1 (000) 000-0000'}</a>
                      <a href="${data.websiteUrl}" class="website">${data.website || 'website.com'}</a>
                    </div>
                  </td>
                  <td width="16"></td>
                  <td valign="bottom">
                    <img src="${logoSrc}" class="sig-logo" alt="SpendRule" />
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      `;
    }
    
    // Get current form data
    function getFormData() {
      return {
        fullName: inputs.fullName.value.trim(),
        jobTitle: inputs.jobTitle.value.trim(),
        email: inputs.email.value.trim(),
        phone: inputs.phone.value.trim(),
        photoUrl: inputs.photoUrl.value.trim(),
        website: inputs.website.value.trim(),
        websiteUrl: inputs.websiteUrl.value.trim()
      };
    }
    
    // Update preview
    function updatePreview() {
      const data = getFormData();
      previewEl.innerHTML = generatePreviewHtml(data);
      htmlCodeEl.textContent = generateSignatureHtml(data);
    }
    
    // Copy signature (rich text for email clients)
    async function copySignature() {
      const data = getFormData();
      const html = generateSignatureHtml(data);
      
      try {
        const blob = new Blob([html], { type: 'text/html' });
        const clipboardItem = new ClipboardItem({ 'text/html': blob });
        await navigator.clipboard.write([clipboardItem]);
        showMessage('success', '‚úì Signature copied! Paste into your email client.');
      } catch (err) {
        // Fallback
        const temp = document.createElement('div');
        temp.innerHTML = html;
        temp.style.position = 'fixed';
        temp.style.left = '-9999px';
        document.body.appendChild(temp);
        
        const range = document.createRange();
        range.selectNodeContents(temp);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        
        document.execCommand('copy');
        
        selection.removeAllRanges();
        document.body.removeChild(temp);
        
        showMessage('success', '‚úì Signature copied! Paste into your email client.');
      }
    }
    
    // Copy HTML code
    async function copyHtmlCode() {
      const data = getFormData();
      const html = generateSignatureHtml(data);
      
      try {
        await navigator.clipboard.writeText(html);
        showMessage('success', '‚úì HTML code copied to clipboard!');
      } catch (err) {
        const textarea = document.createElement('textarea');
        textarea.value = html;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        showMessage('success', '‚úì HTML code copied to clipboard!');
      }
    }
    
    // Download HTML file
    function downloadHtml() {
      const data = getFormData();
      const html = generateSignatureHtml(data);
      const filename = `signature-${data.fullName.toLowerCase().replace(/\s+/g, '-')}.html`;
      
      const blob = new Blob([html], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      showMessage('success', `‚úì Downloaded ${filename}`);
    }
    
    // Show message
    function showMessage(type, text) {
      messageBox.textContent = text;
      messageBox.className = `message ${type} show`;
      
      setTimeout(() => {
        messageBox.classList.remove('show');
      }, 3000);
    }
    
    // Hosting guide modal
    function showHostingGuide() {
      document.getElementById('hostingModal').classList.add('show');
      document.body.style.overflow = 'hidden';
    }
    
    function closeHostingGuide(event) {
      if (!event || event.target === document.getElementById('hostingModal')) {
        document.getElementById('hostingModal').classList.remove('show');
        document.body.style.overflow = '';
      }
    }
    
    // Close modal on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeHostingGuide();
      }
    });
    
    // Add event listeners to all inputs
    Object.values(inputs).forEach(input => {
      input.addEventListener('input', updatePreview);
    });
    
    // Initial render
    updatePreview();
  </script>
</body>
</html>
